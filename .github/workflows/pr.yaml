# .github/workflows/pr-check.yml
name: PR Check

on:
  pull_request:

jobs:
  bandit-test:
    name: bandit-test ðŸ”Ž ðŸ”’
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          ref: ${{ github.ref }}
      - name: Get Changed Files
        id: changed-files
        run: echo "files=$(echo -n $(git diff --name-only origin/${{ github.event.repository.default_branch }} || echo '/dev/null'))" >> $GITHUB_OUTPUT
      - name: Bandit Scan
        uses: bassemgabr1/bandit-action@master
        with:
          GITHUB_TOKEN: ${{ secrets.XGITHUB_TOKEN }}
          SLACK_TOKEN: ${{ secrets.SLACK_TOKEN_BASSEM }}
          SLACK_USERNAME: bandit-test
          SLACK_CHANNEL: bassem-test
          SLACK_NOTIFY: true
          exit_zero: DEFAULT
          path: ${{ steps.changed-files.outputs.files }}
          level: medium
          confidence: high